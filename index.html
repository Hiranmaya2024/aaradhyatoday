
<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AAradhya Customers</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>

body{font-family:Poppins;margin:0;background:#f4f6f9}

.header{background:#0d6efd;color:#fff;padding:15px;font-weight:600}

.routeBox{
background:#fff;
margin:10px;
padding:12px;
border-radius:12px;
box-shadow:0 2px 8px rgba(0,0,0,0.08)
}

.list{padding:10px;display:grid;gap:10px}

.customer{
background:#fff;
padding:14px;
border-radius:12px;
box-shadow:0 2px 6px rgba(0,0,0,0.08)
}

.searchBox{padding:10px;background:#fff;position:sticky;top:56px}

input{
width:100%;
padding:12px;
border-radius:10px;
border:1px solid #ddd;
font-size:16px
}

.tourBtn{
margin-top:10px;
width:100%;
padding:12px;
border:none;
border-radius:10px;
background:#ff9800;
color:#fff;
font-weight:600
}

</style>
</head>

<body>

<div class="header">AAradhya Tour System</div>

<div id="routeBox" class="routeBox"></div>

<div class="searchBox">
<input type="text" placeholder="Search customer..." onkeyup="searchCustomer(this.value)">
<button class="tourBtn" onclick="startTour()">ðŸ§­ Start Todayâ€™s Tour</button>
</div>

<div class="list" id="customerList"></div>

<script>

const csvUrl="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ3bMMFf71-vdGNiWFnf7pD9XuAAUSA7J-g08ocyC2LNiVOTUHi56lB-7bKTKj0KK9nJGs9vU0THQ0E/pub?gid=1044390124&single=true&output=csv"

const tourPlan={
Monday:["Juria"],
Tuesday:["Ghess"],
Wednesday:["Gaisilate"],
Thursday:["Dava"],
Friday:["Padampur"],
Saturday:["Paikmal","Mandosil"]
}

let today=new Date().toLocaleDateString('en-US',{weekday:'long'})
let todayAreas=tourPlan[today]||[]

let customers=[]
let todayRoute=[]

fetch(csvUrl)
.then(res=>res.text())
.then(text=>{

let rows=text.split("\n").slice(1)

customers=rows.map(r=>{
let c=r.split(",")
return{
name:c[0],
area:c[1],
due:parseFloat(c[6])||0,
lat:parseFloat(c[14]),
lng:parseFloat(c[15])
}
})

todayRoute=customers.filter(c=>todayAreas.includes(c.area))

showRoute()
renderList(customers)

})

function showRoute(){

routeBox.innerHTML=`
<h3>ðŸ—“ Todayâ€™s Route â€“ ${todayAreas.join(", ")} (${todayRoute.length} Parties)</h3>
${todayRoute.map((c,i)=>`${i+1}. ${c.name}`).join("<br>")}
`
}

function renderList(data){

customerList.innerHTML=""

data.forEach(c=>{
customerList.innerHTML+=`
<div class="customer">
<b>${c.name}</b><br>
Area: ${c.area} <br>
Due â‚¹${c.due}
</div>`
})
}

function searchCustomer(val){
let filtered=customers.filter(c=>c.name.toLowerCase().includes(val.toLowerCase()))
renderList(filtered)
}

function startTour(){

let route=todayRoute
.filter(c=>c.lat)
.map(c=>`${c.lat},${c.lng}`)
.join("/")

window.open(`https://www.google.com/maps/dir/${route}`)
}

</script>

</body>
</html>